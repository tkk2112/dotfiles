---
- name: Create tldr share directory
  ansible.builtin.file:
    path: "{{ ansible_env.HOME }}/.local/share/tldr"
    state: directory
    mode: "0755"

- name: Check for existing tldr pages
  ansible.builtin.find:
    paths: "{{ ansible_env.HOME }}/.local/share/tldr"
    file_type: any
  register: tldr_files

- name: Initial tldr pages download
  ansible.builtin.command: tldr -u
  changed_when: true
  when: tldr_files.matched | int == 0

- name: Create weekly timer for tldr updates
  systemd_timer:
    name: tldr-update
    job: /usr/bin/tldr -u
    schedule: Sun, 03:48
